<?
	include "include/config.inc";
	$page["title"] = "Hosts";
	$page["file"] = "hosts.html";
	show_header($page["title"],0,0);
?>

<?
	if(isset($register))
	{
		if($register=="add")
		{
			$result=add_host($host,$port,$status,$template,$useip,$ip);
			show_messages($result,"Host added","Cannot add host");
		}
		if($register=="changestatus")
		{
			$result=update_host_status($hostid,$status);
			show_messages($result,"Host status updated","Cannot update host status");
		}
		if($register=="delete")
		{
			$result=delete_host($hostid);
			show_messages($result,"Host deleted","Cannot delete host");
			unset($hostid);
		}
	}
?>

<?
	show_table_header("CONFIGURATION OF HOSTS");
	echo "<br>";
?>

<?
	show_table_header("HOSTS");
	echo "<TABLE BORDER=0 COLS=4 WIDTH=\"100%\" BGCOLOR=\"#CCCCCC\" cellspacing=1 cellpadding=3>";
	echo "<TD WIDTH=\"10%\" NOSAVE><B>Host</B></TD>";
	echo "<TD WIDTH=\"10%\" NOSAVE><B>Port</B></TD>";
	echo "<TD WIDTH=\"10%\" NOSAVE><B>Status</B></TD>";
	echo "<TD WIDTH=\"10%\" NOSAVE><B>Actions</B></TD>";
	echo "</TR>";

	$result=DBselect("select h.hostid,h.host,h.port,h.status from hosts h order by h.host");
	echo "<CENTER>";
	$col=0;
	for($i=0;$i<DBnum_rows($result);$i++)
	{
		if($col==1)
		{
			echo "<TR BGCOLOR=#EEEEEE>";
			$col=0;
		} else
		{
			echo "<TR BGCOLOR=#DDDDDD>";
			$col=1;
		}
	
		$hostid=DBget_field($result,$i,0);
		$host=DBget_field($result,$i,1);
		$port=DBget_field($result,$i,2);
		$status=DBget_field($result,$i,3);
		echo "<TD><a href=\"items.html?hostid=$hostid\">$host</a></TD>";
		echo "<TD>$port</TD>";
		echo "<TD>";
		if($status == 0)	
			echo "<a href=\"hosts.html?hostid=$hostid&register=changestatus&status=1\">Monitored</a>";
		else if($status == 1)
			echo "<a href=\"hosts.html?hostid=$hostid&register=changestatus&status=0\">Not monitored</a>";
		else
			echo "Unknown";
		echo "</TD>";
		echo "<TD><A HREF=\"hosts.html?register=delete&hostid=$hostid\">Delete</A></TD>";
		echo "</TR>";
	}
	echo "</TABLE>";
?>

<?
	echo "<br>";
	show_table2_header_begin();
	echo "New host";

	show_table2_v_delimiter();
	echo "<form method=\"post\" action=\"hosts.html\">";
	echo "Host";
	show_table2_h_delimiter();
	echo "<input name=\"host\" size=20>";

	show_table2_v_delimiter();
	echo "Use IP address";
	show_table2_h_delimiter();
	echo "<INPUT TYPE=\"CHECKBOX\"";
	echo " NAME=\"useip\"  VALUE=\"true\">";

	show_table2_v_delimiter();
	echo "IP address";
	show_table2_h_delimiter();
	echo "<input name=\"ip\" size=15>";

	show_table2_v_delimiter();
	echo "Port";
	show_table2_h_delimiter();
	echo "<input name=\"port\" size=5 value=\"10000\">";

	show_table2_v_delimiter();
	echo "Status";
	show_table2_h_delimiter();
	echo "<select name=\"status\" size=\"1\">";
	echo "<option value=\"0\" \"selected\">Monitored";
	echo "<option value=\"1\">Not monitored";
	echo "</select>";

	show_table2_v_delimiter();
	echo "Add parameters supported by zabbix_agent";
	show_table2_h_delimiter();
	echo "<INPUT TYPE=\"CHECKBOX\" CHECKED ";
	echo " NAME=\"template\"  VALUE=\"true\">";

	show_table2_v_delimiter2();
	echo "<input type=\"submit\" name=\"register\" value=\"add\">";

	show_table2_header_end();
?>

<?
	show_footer();
?>
